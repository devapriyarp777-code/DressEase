{% extends "base.html" %}

{% block content %}
<div class="card">
    <h1>Find a Match</h1>
    <p style="text-align: center; color: var(--text-muted); margin-bottom: 2rem;">
        Upload an item from your wardrobe, and AI will find the perfect matching piece!
    </p>

    <!-- File Upload Form for AI Detection -->
    <form action="/find_match" method="POST" enctype="multipart/form-data"
        style="max-width: 600px; margin: 0 auto; text-align: center;">
        <div class="form-group">
            <label for="image">Upload Wardrobe Item</label>
            <input type="file" name="image" id="image" accept="image/*" required
                style="width: 100%; padding: 0.75rem 1rem; border: 1px dashed var(--primary-color); border-radius: var(--radius-md); background-color: var(--bg-color); cursor: pointer;">
        </div>
        <button type="submit" class="btn">Find Match ðŸŽ¯</button>
    </form>
</div>

{% if uploaded_image or matched_item %}
<div class="card" style="margin-top: 2rem;">
    <h2>AI Recommended Match</h2>
    <div class="match-display">
        <!-- Selected Item -->
        <div class="outfit-piece">
            <h3 style="margin-bottom: 0.5rem; font-size: 1.1rem; color: var(--text-muted);">You Selected</h3>
            {% if uploaded_image %}
            <img src="{{ url_for('static', filename=uploaded_image.replace('static/', '')) }}" alt="Uploaded Item">
            {% if detected_type and detected_color %}
            <h3 style="text-transform: capitalize;">{{ detected_color }} {{ detected_type }}</h3>
            <span class="badge">AI Detected</span>
            {% endif %}
            {% else %}
            <p>No image provided.</p>
            {% endif %}
        </div>

        <div class="plus-sign">+</div>

        <!-- Matched Item -->
        <div class="outfit-piece">
            <h3 style="margin-bottom: 0.5rem; font-size: 1.1rem; color: var(--text-muted);">AI Suggests</h3>
            {% if matched_item %}
            <img src="{{ url_for('static', filename=matched_item.image) }}" alt="Match Item">
            <h3 style="text-transform: capitalize;">{{ matched_item.color }} {{ matched_item.type }}</h3>
            <span class="badge">{{ matched_item.mood }}</span>
            <span class="badge">{{ matched_item.occasion }}</span>
            {% else %}
            <div
                style="height: 300px; display: flex; align-items: center; justify-content: center; background: var(--bg-color); border-radius: var(--radius-lg);">
                <p style="color: var(--text-muted);">No suitable match found in wardrobe.</p>
            </div>
            {% endif %}
        </div>
    </div>
</div>
{% endif %}
{% endblock %}